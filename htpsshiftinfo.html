<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Harduaganj Thermal Power Station Shift Checker - 2026</title>
    
    <!-- PWA Meta Tags for Add to Home Screen -->
    <meta name="theme-color" content="#0d6efd">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="manifest" href="data:application/manifest+json,{
        'name': 'HTPS Shift Checker',
        'short_name': 'Shift Checker',
        'start_url': '.',
        'display': 'standalone',
        'background_color': '#ffffff',
        'theme_color': '#0d6efd',
        'icons': [
            {
                'src': 'https://via.placeholder.com/192?text=Shift',
                'sizes': '192x192',
                'type': 'image/png'
            },
            {
                'src': 'https://via.placeholder.com/512?text=Shift',
                'sizes': '512x512',
                'type': 'image/png'
            }
        ]
    }">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        /* Same styles as before */
        body { background: linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 100%); min-height: 100vh; font-family: system-ui, sans-serif; padding: 1rem; }
        .card { border: none; border-radius: 16px; overflow: hidden; box-shadow: 0 10px 35px rgba(0,0,0,0.12); max-width: 520px; margin: 0 auto; }
        .card-header { background: linear-gradient(90deg, #0d6efd, #0b5ed7); color: white; padding: 1.4rem; text-align: center; font-weight: 600; }
        .form-label { font-weight: 600; color: #2c3e50; margin-bottom: 0.4rem; }
        .btn-check { font-size: 1.15rem; padding: 0.95rem; font-weight: bold; border-radius: 12px; background: #0d6efd; border: none; }
        .btn-check:hover { background: #0b5ed7; }
        .shift-badge { font-size: 1.05rem; padding: 0.75em 1.3em; border-radius: 999px; font-weight: 700; display: inline-block; margin: 0.5rem 0; box-shadow: 0 3px 10px rgba(0,0,0,0.12); width: 100%; text-align: center; }
        .morning { background: #ffeb3b; color: #1a1a1a; }
        .evening  { background: #ff9800; color: white; }
        .night    { background: #1a237e; color: white; }
        .rest     { background: #27ae60; color: white; }
        .info-item { padding: 1.2rem 0; border-bottom: 1px solid #e9ecef; }
        .info-item:last-child { border-bottom: none; }
        .time-display { font-size: 1.35rem; font-weight: 700; color: #0d6efd; text-align: center; margin: 1.2rem 0; }
        .note { font-size: 0.85rem; color: #6c757d; text-align: center; margin-top: 1.5rem; padding: 0.8rem; background: #fff; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .footer { text-align: center; padding: 1.2rem; color: #6c757d; font-size: 0.9rem; background: #f8f9fa; border-top: 1px solid #dee2e6; }
        .footer strong { color: #343a40; }

        /* Popup Styles */
        #addToHomePopup {
            position: fixed;
            bottom: 20px;
            left: 10px;
            right: 10px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
            padding: 1.5rem;
            z-index: 1000;
            display: none;
            animation: slideUp 0.5s ease-out;
        }
        #addToHomePopup.show { display: block; }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to   { transform: translateY(0); opacity: 1; }
        }
        .popup-btn { margin-top: 1rem; }
    </style>
</head>
<body>

<div class="container py-4">
    <div class="card mx-auto">
        <div class="card-header">
            <h5>Harduaganj Thermal Power Station<br>Shift Checker ‚Äì 2026</h5>
        </div>

        <div class="card-body px-4 py-4">
            <div class="mb-4">
                <label class="form-label">Date</label>
                <input type="date" class="form-control form-control-lg" id="date" min="2020-01-01">
            </div>

            <button class="btn btn-primary w-100 btn-check mb-4" onclick="checkShift()">
                View Current Shift
            </button>

            <div id="result" class="mt-3"></div>

            <div class="note">
                Note: Night shift is considered from 22:00 on the evening of the displayed date to 06:00 the next morning.
            </div>
        </div>

        <div class="footer">
            <strong>Developed by Chairy Foundation</strong><br>
            <small>Automatically shows today's shift ‚Ä¢ Works offline too</small>
        </div>
    </div>
</div>

<!-- Add to Home Screen Popup -->
<div id="addToHomePopup" class="text-center">
    <h5>Add to Home Screen</h5>
    <p style="margin: 0.8rem 0;">
        For quick access, add this page to your home screen like an app!<br>
        <small>(Tap the menu button ‚Üí Add to Home screen)</small>
    </p>
    <div class="popup-btn">
        <button class="btn btn-primary" onclick="document.getElementById('addToHomePopup').classList.remove('show')">
            Got it! Add Now
        </button>
        <button class="btn btn-link text-muted mt-2" onclick="document.getElementById('addToHomePopup').classList.remove('show')">
            Close
        </button>
    </div>
</div>

<script>
// Your existing shift logic here (same as before)
const groups = { A: 0, B: 9, C: 3, D: 6 };

const positions = [
    {name: "First Evening",   type: "evening",   cls: "evening",   icon: "üåÖ"},
    {name: "Second Evening",  type: "evening",   cls: "evening",   icon: "üåÖ"},
    {name: "Third Evening",   type: "evening",   cls: "evening",   icon: "üåÖ"},
    {name: "Rest (32 hrs)",   type: "rest",      cls: "rest",      icon: "üü¢"},
    {name: "First Morning",   type: "morning",   cls: "morning",   icon: "‚òÄÔ∏è"},
    {name: "Second Morning",  type: "morning",   cls: "morning",   icon: "‚òÄÔ∏è"},
    {name: "Third Morning",   type: "morning",   cls: "morning",   icon: "‚òÄÔ∏è"},
    {name: "First Night",     type: "night",     cls: "night",     icon: "üåô"},
    {name: "Second Night",    type: "night",     cls: "night",     icon: "üåô"},
    {name: "Third Night",     type: "night",     cls: "night",     icon: "üåô"},
    {name: "Rest (56 hrs)",   type: "rest",      cls: "rest",      icon: "üü¢"},
    {name: "Rest (56 hrs)",   type: "rest",      cls: "rest",      icon: "üü¢"}
];

function daysSinceJan1_2026(dateStr) {
    const ref = new Date('2026-01-01T00:00:00Z');
    const d = new Date(dateStr + 'T00:00:00Z');
    const diffMs = d - ref;
    return Math.floor(diffMs / 86400000);
}

function checkShift() {
    let dateStr = document.getElementById('date').value;
    if (!dateStr) {
        const today = new Date();
        dateStr = today.toISOString().split('T')[0];
        document.getElementById('date').value = dateStr;
    }

    const dayNum = daysSinceJan1_2026(dateStr);
    const selectedDate = new Date(dateStr);

    const displayDate = selectedDate.toLocaleDateString('en-IN', {
        weekday: 'long',
        day: 'numeric',
        month: 'long',
        year: 'numeric'
    });

    let morning = '', evening = '', night = '';
    const rows = [];
    let restGroup = '';

    for (const [group, offset] of Object.entries({A:0, B:9, C:3, D:6})) {
        let pos = (dayNum + offset) % 12;
        if (pos < 0) pos += 12;

        const info = positions[pos];
        rows.push(`
            <tr>
                <td><strong>${group}</strong></td>
                <td>${info.name}</td>
            </tr>
        `);

        if (info.type === "morning")   morning = `${group} ‚Äì ${info.name}`;
        if (info.type === "evening")   evening = `${group} ‚Äì ${info.name}`;
        if (info.type === "night")     night   = `${group} ‚Äì ${info.name}`;
        if (info.type === "rest")      restGroup = group;
    }

    document.getElementById('result').innerHTML = `
        <div class="time-display">${displayDate}</div>

        <div class="info-item">
            <strong>Morning 06:00‚Äì14:00</strong><br>
            <span class="shift-badge morning">‚òÄÔ∏è ${morning || 'None'}</span>
        </div>

        <div class="info-item">
            <strong>Evening 14:00‚Äì22:00</strong><br>
            <span class="shift-badge evening">üåÖ ${evening || 'None'}</span>
        </div>

        <div class="info-item">
            <strong>Night 22:00‚Äì06:00</strong><br>
            <span class="shift-badge night">üåô ${night || 'None'}</span>
        </div>

        <div class="info-item">
            <strong>On Rest Today:</strong><br>
            <span class="shift-badge rest">üü¢ Group ${restGroup || 'None'} ‚Äì Rest Day</span>
        </div>

        <table class="table table-sm mt-4">
            <thead>
                <tr>
                    <th>Group</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>${rows.join('')}</tbody>
        </table>
    `;
}

// Auto load current date and show shift
window.addEventListener('load', () => {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('date').value = today;
    checkShift();

    // Show Add to Home Screen popup after 2 seconds
    setTimeout(() => {
        document.getElementById('addToHomePopup').classList.add('show');
    }, 2000);
});

// Auto update on date change
document.getElementById('date').addEventListener('change', checkShift);
</script>
</body>
</html>
